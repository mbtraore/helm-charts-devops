global:
  kibanaEnabled: true
  elasticsearch:
    service:
      name: elastic-elasticsearch
elasticsearch:
  fullnameOverride: elastic-elasticsearch
  nameOverride: elastic
  ingress:
    enabled: true
    hostname: elastic-new.user.lab.sspcloud.fr
    tls: true
    selfSigned: false
    ingressClassName: onyxia
    annotations: 
      nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
      nginx.ingress.kubernetes.io/ssl-passthrough: "true"

  security:
    enabled: true
    elasticPassword: "changeme"
    tls:
      autoGenerated: true

  kibana:
    fullnameOverride: elastic-kibana
#    nameOverride: kibana
#    ingress:
#      enabled: true
#      hostname: kibana-new.user.lab.sspcloud.fr
#      tls: true
#      ingressClassName: onyxia
#      annotations: 
#        nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
#        nginx.ingress.kubernetes.io/ssl-passthrough: "true"

    elasticsearch:
      hosts:
        - elastic-elasticsearch
      security:
        auth:
          enabled: true
          # default in the elasticsearch chart is elastic 
          #kibanaUsername: "elastic" #-- not used since v8.0
          kibanaPassword: "changeme"
          createSystemUser: true
          #existingSecret: elastic-elasticsearch
          elasticsearchPasswordSecret: "elastic-elasticsearch" 
        tls:
          # Instruct kibana to connect to elastic over https
          enabled: true
          # Bit of a catch 22, as you will need to know the name upfront of your release
          existingSecret: "elastic-elasticsearch-coordinating-crt"
          # As the certs are auto-generated, they are pemCerts so set to true
          usePemCerts: true
    
    tls:
      enabled: true
      # AutoGenerate TLS certs for kibana
      autoGenerated: true

ingress:
  enabled: true
  ingressClassName: "onyxia"
  tls: true
  hostname: "kibana-new.user.lab.sspcloud.fr"
  usecertManager: false
  annotations: 
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    nginx.ingress.kubernetes.io/ssl-passthrough: "true"

